<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FMAP - Farcaster Map NFT</title>
  
  <!-- Farcaster Frame Meta Tags -->
  <meta property="fc:frame" content="vNext" />
  <meta property="fc:frame:image" content="https://fmap-nft.vercel.app/frame-image.png" />
  <meta property="fc:frame:image:aspect_ratio" content="1:1" />
  
  <meta property="fc:frame:button:1" content="ðŸš€ Launch App" />
  <meta property="fc:frame:button:1:action" content="link" />
  <meta property="fc:frame:button:1:target" content="https://fmap-nft.vercel.app" />
  
  <meta property="fc:frame:button:2" content="ðŸ“Š View Stats" />
  <meta property="fc:frame:button:2:action" content="post" />
  
  <meta property="fc:frame:button:3" content="ðŸ”— BaseScan" />
  <meta property="fc:frame:button:3:action" content="link" />
  <meta property="fc:frame:button:3:target" content="https://basescan.org/address/0xf9bb77aA3C2F5e7A3387331aa596269fE5920bF3" />
  
  <meta property="fc:frame:post_url" content="https://fmap-nft.vercel.app/api/frame" />
  
  <!-- Open Graph -->
  <meta property="og:title" content="FMAP - Farcaster Map NFT" />
  <meta property="og:description" content="Mint your on-chain generated pixel art NFT on Base. 10K supply, $0.25 each!" />
  <meta property="og:image" content="https://fmap-nft.vercel.app/og-image.png" />
  
  <!-- Farcaster Mini App SDK -->
  <script src="https://unpkg.com/@farcaster/frame-sdk@0.0.5/dist/index.js"></script>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700;900&display=swap" rel="stylesheet">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'JetBrains Mono', monospace; }
    body { background: #000; color: #fff; overflow-x: hidden; }
    
    .stars { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
    .star { position: absolute; background: white; border-radius: 50%; animation: pulse 2s infinite; opacity: 0.6; }
    @keyframes pulse { 0%, 100% { opacity: 0.6; } 50% { opacity: 1; } }
    
    .gradient-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(180deg, rgba(147, 51, 234, 0.2) 0%, transparent 50%, rgba(59, 130, 246, 0.2) 100%); pointer-events: none; z-index: 2; }
    .container { position: relative; z-index: 10; }
    
    header { border-bottom: 1px solid #1f2937; background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(10px); }
    .header-content { max-width: 1200px; margin: 0 auto; padding: 1rem 1.5rem; display: flex; justify-content: space-between; align-items: center; }
    .logo { display: flex; align-items: center; gap: 0.75rem; }
    .logo-icon { width: 40px; height: 40px; background: linear-gradient(135deg, #a855f7, #3b82f6); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: 900; }
    .logo-text { font-size: 1.5rem; font-weight: 900; letter-spacing: 0.05em; }
    
    .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 0.5rem; color: white; }
    .btn-primary { background: linear-gradient(90deg, #9333ea, #3b82f6); }
    .btn-primary:hover { transform: scale(1.05); }
    .wallet-info { padding: 0.5rem 1rem; background: #1f2937; border: 1px solid #374151; border-radius: 8px; font-size: 0.875rem; display: none; }
    
    main { max-width: 1000px; margin: 0 auto; padding: 4rem 1.5rem; }
    .hero { text-align: center; margin-bottom: 3rem; }
    .hero-title { font-size: 4rem; font-weight: 900; margin-bottom: 1rem; background: linear-gradient(90deg, #c084fc, #f472b6, #60a5fa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: pulse 2s infinite; }
    .hero-subtitle { font-size: 1.25rem; color: #9ca3af; margin-bottom: 0.5rem; }
    
    .nft-preview { display: flex; justify-content: center; margin-bottom: 3rem; }
    .nft-frame { width: 256px; height: 256px; background: linear-gradient(135deg, #581c87, #1e3a8a, #831843); border-radius: 16px; padding: 4px; }
    .nft-inner { width: 100%; height: 100%; background: #000; border-radius: 12px; display: flex; align-items: center; justify-content: center; }
    .pixel-grid { display: grid; grid-template-columns: repeat(8, 1fr); gap: 4px; padding: 1rem; }
    .pixel { width: 16px; height: 16px; border-radius: 2px; animation: pulse 2s infinite; }
    
    .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 3rem; }
    .stat-card { background: rgba(17, 24, 39, 0.5); backdrop-filter: blur(10px); border: 1px solid #1f2937; border-radius: 12px; padding: 1.5rem; text-align: center; }
    .stat-value { font-size: 2rem; font-weight: 900; margin-bottom: 0.5rem; }
    .stat-label { font-size: 0.875rem; color: #9ca3af; }
    
    .mint-section { background: rgba(17, 24, 39, 0.5); backdrop-filter: blur(10px); border: 1px solid #1f2937; border-radius: 16px; padding: 2rem; margin-bottom: 2rem; }
    .section-title { font-size: 1.5rem; font-weight: 900; margin-bottom: 1.5rem; text-align: center; }
    .mint-controls { max-width: 448px; margin: 0 auto; }
    
    .amount-control { margin-bottom: 1.5rem; }
    .amount-label { display: block; font-size: 0.875rem; color: #9ca3af; margin-bottom: 0.5rem; }
    .amount-input-group { display: flex; align-items: center; gap: 1rem; }
    .amount-btn { width: 48px; height: 48px; background: #1f2937; border: none; border-radius: 8px; font-size: 1.25rem; font-weight: 700; color: white; cursor: pointer; }
    .amount-input { flex: 1; height: 48px; background: #1f2937; border: 1px solid #374151; border-radius: 8px; text-align: center; font-size: 1.5rem; font-weight: 700; color: white; }
    
    .cost-info { background: rgba(31, 41, 55, 0.5); border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem; }
    .cost-row { display: flex; justify-content: space-between; margin-bottom: 0.5rem; }
    .cost-label { color: #9ca3af; }
    .cost-value { font-weight: 700; }
    
    .btn-mint { width: 100%; padding: 1rem; background: linear-gradient(90deg, #9333ea, #3b82f6); border: none; border-radius: 12px; font-size: 1.125rem; font-weight: 900; color: white; cursor: pointer; }
    .btn-mint:disabled { background: linear-gradient(90deg, #374151, #1f2937); cursor: not-allowed; }
    
    .status-message { margin-top: 1rem; padding: 1rem; border-radius: 8px; display: none; }
    
    footer { border-top: 1px solid #1f2937; padding: 1.5rem; text-align: center; }
    .footer-link { color: #60a5fa; text-decoration: none; }
    
    @media (max-width: 768px) {
      .hero-title { font-size: 2.5rem; }
      .stats { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="stars" id="stars"></div>
  <div class="gradient-overlay"></div>
  
  <div class="container">
    <header>
      <div class="header-content">
        <div class="logo">
          <div class="logo-icon">F</div>
          <div class="logo-text">FMAP</div>
        </div>
        <button id="connectBtn" class="btn btn-primary">Connect Wallet</button>
        <div id="walletInfo" class="wallet-info">
          <span id="walletAddress"></span>
        </div>
      </div>
    </header>
    
    <main>
      <div class="hero">
        <h1 class="hero-title">FARCASTER MAP</h1>
        <p class="hero-subtitle">Pixel Art NFT Collection on Base</p>
      </div>
      
      <div class="nft-preview">
        <div class="nft-frame">
          <div class="nft-inner">
            <div class="pixel-grid" id="pixelGrid"></div>
          </div>
        </div>
      </div>
      
      <div class="stats">
        <div class="stat-card">
          <div class="stat-value" style="color: #a855f7;"><span id="totalMinted">0</span>/10000</div>
          <div class="stat-label">Minted</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" style="color: #60a5fa;">$0.25</div>
          <div class="stat-label">Mint Price</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" style="color: #f472b6;">10</div>
          <div class="stat-label">Max Per Wallet</div>
        </div>
      </div>
      
      <div class="mint-section">
        <h3 class="section-title">Mint Your FMAP NFT</h3>
        <div class="mint-controls">
          <div class="amount-control">
            <label class="amount-label">Amount (<span id="userMinted">0</span>/10 minted)</label>
            <div class="amount-input-group">
              <button class="amount-btn" id="decreaseBtn">-</button>
              <input type="number" class="amount-input" id="mintAmount" value="1" min="1" max="10">
              <button class="amount-btn" id="increaseBtn">+</button>
            </div>
          </div>
          <div class="cost-info">
            <div class="cost-row">
              <span class="cost-label">Total Cost:</span>
              <span class="cost-value" id="totalCostETH">0.00025 ETH</span>
            </div>
            <div class="cost-row">
              <span class="cost-label">â‰ˆ USD:</span>
              <span class="cost-value" id="totalCostUSD">$0.25</span>
            </div>
          </div>
          <button class="btn-mint" id="mintBtn" disabled>Mint Now</button>
        </div>
      </div>
    </main>
    
    <footer>
      <a href="https://x.com/ega_2ez4crypto" target="_blank" class="footer-link">@ega_2ez4crypto</a>
    </footer>
  </div>

  <script>
    const CONTRACT_ADDRESS = '0xf9bb77aA3C2F5e7A3387331aa596269fE5920bF3';
    const MINT_PRICE = 0.00025;
    let account = null;

    // Initialize Farcaster SDK if in Mini App
    if (window.frameSDK) {
      window.frameSDK.actions.ready();
      console.log('Farcaster SDK initialized');
    }

    // Generate stars
    const starsContainer = document.getElementById('stars');
    for (let i = 0; i < 100; i++) {
      const star = document.createElement('div');
      star.className = 'star';
      star.style.left = Math.random() * 100 + '%';
      star.style.top = Math.random() * 100 + '%';
      star.style.width = (Math.random() * 3 + 1) + 'px';
      star.style.height = star.style.width;
      star.style.animationDuration = (Math.random() * 3 + 2) + 's';
      starsContainer.appendChild(star);
    }

    // Generate pixel grid
    const pixelGrid = document.getElementById('pixelGrid');
    for (let i = 0; i < 64; i++) {
      const pixel = document.createElement('div');
      pixel.className = 'pixel';
      pixel.style.backgroundColor = 'hsl(' + ((i * 137.5) % 360) + ', 70%, 50%)';
      pixel.style.animationDelay = (i * 0.02) + 's';
      pixelGrid.appendChild(pixel);
    }

    function updateCost() {
      const amount = parseInt(document.getElementById('mintAmount').value) || 1;
      document.getElementById('totalCostETH').textContent = (MINT_PRICE * amount).toFixed(6) + ' ETH';
      document.getElementById('totalCostUSD').textContent = '$' + (MINT_PRICE * amount * 4000).toFixed(2);
    }

    document.getElementById('connectBtn').addEventListener('click', async function() {
      if (typeof window.ethereum === 'undefined') {
        alert('Please install MetaMask!');
        return;
      }

      try {
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        const chainId = await window.ethereum.request({ method: 'eth_chainId' });

        if (chainId !== '0x2105') {
          await window.ethereum.request({
            method: 'wallet_switchEthereumChain',
            params: [{ chainId: '0x2105' }]
          }).catch(async (error) => {
            if (error.code === 4902) {
              await window.ethereum.request({
                method: 'wallet_addEthereumChain',
                params: [{
                  chainId: '0x2105',
                  chainName: 'Base',
                  nativeCurrency: { name: 'ETH', symbol: 'ETH', decimals: 18 },
                  rpcUrls: ['https://mainnet.base.org'],
                  blockExplorerUrls: ['https://basescan.org']
                }]
              });
            }
          });
        }

        account = accounts[0];
        document.getElementById('connectBtn').style.display = 'none';
        document.getElementById('walletInfo').style.display = 'block';
        document.getElementById('walletAddress').textContent = account.slice(0, 6) + '...' + account.slice(-4);
        document.getElementById('mintBtn').disabled = false;
      } catch (error) {
        console.error('Connection error:', error);
      }
    });

    document.getElementById('decreaseBtn').addEventListener('click', () => {
      const input = document.getElementById('mintAmount');
      if (input.value > 1) {
        input.value = parseInt(input.value) - 1;
        updateCost();
      }
    });

    document.getElementById('increaseBtn').addEventListener('click', () => {
      const input = document.getElementById('mintAmount');
      if (input.value < 10) {
        input.value = parseInt(input.value) + 1;
        updateCost();
      }
    });

    updateCost();
  </script>
</body>
</html>
